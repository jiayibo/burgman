<h1>Listing orders</h1>

<%= grid(@orders_grid, show_filters: :when_filtered, hide_submit_button: true) do |g|

  g.column :name => I18n.t('order.Product'), :attribute => 'preview_file_name', :model => Product, :filter => false do |order|
    link_to (image_tag Product.find(order.product_id).preview.url(:thumb)), edit_order_path(order)
  end

  g.column :name => I18n.t('Customer.weibo'), :attribute => 'weibo', :model => Customer, auto_reload:  true do |order|
    Customer.find(order.customer_id).weibo
  end

  g.column :name => 'Color', :attribute => 'color', auto_reload:  true do |order|
    order.color
  end

  g.column :name => 'Size', :attribute => 'size', auto_reload:  true  do |order|
    order.size
  end

  g.column  :name => 'State', :attribute => 'state', :custom_filter => State.select_options, auto_reload:  true do |order|
    order.state.text
  end

  g.column  :name => 'Price', :attribute => 'price', auto_reload:  true do |order|
    order.price
  end

  g.column  :name => 'Purchase Price', :attribute => 'purchasepri', auto_reload:  true do |order|
    order.currency.to_symbol + order.purchasepri.to_s
  end

  g.column  :name => 'Deposit', :attribute => 'deposit', auto_reload:  true do |order|
    order.deposit
  end

  g.column  :name => 'Commets', :attribute => 'comments', auto_reload:  true do |order|
    order.comments
  end

  g.column :name => 'Employee', :attribute => 'nick', :model => Employee, auto_reload:  true do |order|
    Employee.find(order.employee_id).nick
  end

  g.column   do |order|
    link_to 'Destroy', order, method: :delete, data: { confirm: 'Are you sure?' }
  end
end -%>